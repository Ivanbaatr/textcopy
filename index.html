<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>텍스트 정리 및 복사기</title>
    <!-- Tailwind CSS 로드 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 'Inter' 폰트 사용 */
        :root {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 flex items-center justify-center">

    <div id="app" class="bg-white p-6 md:p-8 rounded-xl shadow-2xl w-full max-w-lg space-y-6">
        <h1 class="text-3xl font-extrabold text-gray-900 text-center border-b pb-3 mb-4">
            텍스트 클리너 (연속된 + & 지정 문자 제거)
        </h1>
        
        <!-- 1.1 제거 문자 지정 영역 (추가된 기능) -->
        <div class="pb-2">
            <label for="removal-chars" class="block text-sm font-medium text-gray-700 mb-2">
                추가로 **제거할 문자 목록**
            </label>
            <input type="text" id="removal-chars" placeholder="예: *^$#@ (여기에 입력된 모든 문자가 텍스트에서 제거됩니다)"
                   class="w-full p-3 border-2 border-red-200 rounded-lg focus:ring-red-500 focus:border-red-500 transition duration-150 shadow-inner placeholder-red-400">
            <p class="text-xs text-gray-500 mt-1">※ 기본적으로 **연속된 '+' 문자**는 항상 제거됩니다.</p>
        </div>
        
        <!-- 1. 입력 영역 (기존) -->
        <div>
            <label for="input-text" class="block text-sm font-medium text-gray-700 mb-2">
                원본 텍스트 (여기에 붙여넣으세요)
            </label>
            <textarea id="input-text" rows="6" placeholder="여기에 텍스트를 붙여넣으세요..."
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 shadow-inner"></textarea>
        </div>

        <!-- 2. 결과 영역 -->
        <div>
            <label for="output-text" class="block text-sm font-medium text-gray-700 mb-2">
                정리된 텍스트
            </label>
            <textarea id="output-text" rows="6" readonly
                class="w-full p-3 border border-gray-300 bg-gray-50 rounded-lg text-gray-800 transition duration-150 font-mono"></textarea>
        </div>

        <!-- 3. 버튼 및 메시지 영역 -->
        <div class="flex flex-col sm:flex-row sm:justify-between items-center gap-4 pt-2">
            <button id="copy-button"
                class="w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-200 transform hover:scale-105 active:scale-95 disabled:bg-indigo-300 disabled:cursor-not-allowed">
                정리하고 복사하기
            </button>
            <span id="message" class="text-sm font-medium text-green-600 opacity-0 transition duration-300"></span>
        </div>
    </div>

    <script>
        // DOM 요소 참조
        const inputTextarea = document.getElementById('input-text');
        const outputTextarea = document.getElementById('output-text');
        const copyButton = document.getElementById('copy-button');
        const messageSpan = document.getElementById('message');
        const removalCharsInput = document.getElementById('removal-chars'); // **새로 추가된 입력 필드**
        const apiKey = "" // API 키를 여기에 넣을 수 있습니다. 현재는 사용하지 않습니다.

        /**
         * 텍스트에서 연속된 '+' 문자와 사용자가 지정한 문자를 제거하고 결과를 출력 textarea에 반영합니다.
         */
        function cleanText() {
            const rawText = inputTextarea.value;
            
            // 1. 연속된 '+' 문자를 제거합니다. (기존 로직)
            // 정규 표현식 /\++/g: 하나 이상의 연속된 '+' 문자를 전역적으로 찾아서 제거
            let cleanedText = rawText.replace(/\++/g, '');

            // 2. 사용자가 지정한 추가 제거 문자를 가져옵니다.
            let additionalChars = removalCharsInput.value.trim();

            if (additionalChars) {
                // 정규 표현식 특수 문자를 이스케이프 처리합니다.
                // 사용자가 입력한 문자가 정규식 문법에 의해 오작동하지 않도록 '\'를 붙여줍니다.
                const escapedChars = additionalChars.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                
                // 추가 제거할 문자들을 찾는 정규식: 예) /[*^$#@]/g
                const removalRegex = new RegExp(`[${escapedChars}]`, 'g');
                
                // 해당 문자들을 제거합니다.
                cleanedText = cleanedText.replace(removalRegex, '');
            }
            
            outputTextarea.value = cleanedText;

            // 출력 텍스트가 비어있으면 복사 버튼을 비활성화합니다.
            if (cleanedText.trim().length > 0) {
                copyButton.disabled = false;
            } else {
                copyButton.disabled = true;
            }
        }

        /**
         * 정리된 텍스트를 클립보드에 복사하고 성공 메시지를 표시합니다.
         */
        function copyToClipboard() {
            const textToCopy = outputTextarea.value;

            if (textToCopy.trim() === "") {
                return; // 텍스트가 없으면 복사하지 않습니다.
            }
            
            try {
                // 텍스트를 클립보드에 복사합니다.
                outputTextarea.select();
                outputTextarea.setSelectionRange(0, 99999); // 모바일 장치 대응
                document.execCommand('copy');
                
                // 성공 메시지 표시
                messageSpan.textContent = '복사 완료! (클립보드에 저장됨)';
                messageSpan.classList.remove('opacity-0', 'text-red-600');
                messageSpan.classList.add('opacity-100', 'text-green-600');

                // 2초 후 메시지 숨기기
                setTimeout(() => {
                    messageSpan.classList.remove('opacity-100');
                    messageSpan.classList.add('opacity-0');
                    messageSpan.textContent = '';
                }, 2000);

            } catch (err) {
                console.error('클립보드 복사 실패:', err);
                messageSpan.textContent = '복사 실패: 콘솔 확인';
                messageSpan.classList.remove('opacity-0', 'text-green-600');
                messageSpan.classList.add('opacity-100', 'text-red-600');
            }
        }

        // --- 이벤트 리스너 설정 ---

        // 1. 입력 텍스트 영역에 내용이 바뀔 때마다 텍스트를 정리합니다.
        inputTextarea.addEventListener('input', cleanText);

        // 1.1. 제거 문자 목록이 바뀔 때도 텍스트를 정리합니다.
        removalCharsInput.addEventListener('input', cleanText);

        // 2. 버튼 클릭 시 텍스트를 복사합니다.
        copyButton.addEventListener('click', copyToClipboard);

        // 초기 상태 설정
        copyButton.disabled = true; 
        cleanText(); // 페이지 로드 시 한 번 실행하여 초기 상태를 설정합니다.

    </script>
</body>
</html>
