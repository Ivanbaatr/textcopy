<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>텍스트 정리 및 복사기</title>
    <!-- Tailwind CSS 로드 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 'Inter' 폰트 사용 */
        :root {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 flex items-center justify-center">

    <div id="app" class="bg-white p-6 md:p-8 rounded-xl shadow-2xl w-full max-w-lg space-y-6">
        <h1 class="text-3xl font-extrabold text-gray-900 text-center border-b pb-3 mb-4">
            텍스트 클리너 (고정 규칙 적용)
        </h1>
        
        <!-- 고정된 규칙 안내 -->
        <div class="p-3 bg-red-50 border-l-4 border-red-500 rounded-lg shadow-sm">
            <p class="text-sm font-semibold text-red-700">
                자동 제거 및 치환 규칙:
            </p>
            <ul class="text-sm text-gray-700 list-disc list-inside ml-2 mt-1">
                <li>**연속된 '+'** 문자 제거</li>
                <li>**'신세계역 성경 (연구용)'** 문구를 **')'** 하나로 치환 (주변 공백 정리 및 **치환 후 문자 2개 추가 제거**)</li>
            </ul>
        </div>
        
        <!-- 1. 입력 영역 -->
        <div>
            <label for="input-text" class="block text-sm font-medium text-gray-700 mb-2">
                원본 텍스트 (여기에 붙여넣으세요)
            </label>
            <textarea id="input-text" rows="8" placeholder="여기에 텍스트를 붙여넣으면 자동으로 정리됩니다."
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 shadow-inner"></textarea>
        </div>

        <!-- 2. 결과 영역 -->
        <div>
            <label for="output-text" class="block text-sm font-medium text-gray-700 mb-2">
                정리된 텍스트
            </label>
            <textarea id="output-text" rows="8" readonly
                class="w-full p-3 border border-gray-300 bg-gray-50 rounded-lg text-gray-800 transition duration-150 font-mono"></textarea>
        </div>

        <!-- 3. 버튼 및 메시지 영역 -->
        <div class="flex flex-col sm:flex-row sm:justify-between items-center gap-4 pt-2">
            <button id="copy-button"
                class="w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-200 transform hover:scale-105 active:scale-95 disabled:bg-indigo-300 disabled:cursor-not-allowed">
                정리하고 복사하기
            </button>
            <span id="message" class="text-sm font-medium text-green-600 opacity-0 transition duration-300"></span>
        </div>
    </div>

    <script>
        // DOM 요소 참조
        const inputTextarea = document.getElementById('input-text');
        const outputTextarea = document.getElementById('output-text');
        const copyButton = document.getElementById('copy-button');
        const messageSpan = document.getElementById('message');
        
        const apiKey = "" // API 키를 여기에 넣을 수 있습니다. 현재는 사용하지 않습니다.


        /**
         * 텍스트에서 고정된 규칙을 적용하여 정리합니다.
         */
        function cleanText() {
            let cleanedText = inputTextarea.value;
            
            // 1. 연속된 '+' 문자를 제거합니다.
            cleanedText = cleanedText.replace(/\++/g, '');
            
            // 2. '신세계역 성경 (연구용)' 문구를 찾아 ')' 하나로 치환하고 주변 공백을 제거하며, 그 뒤의 문자 2개를 제거합니다.
            const phraseToTarget = "신세계역 성경 (연구용)";
            
            // 정규식 안전 처리를 위해 문구 이스케이프
            const escapedPhrase = phraseToTarget.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            
            // 문구 앞뒤의 공백/줄 바꿈 문자(\s, \r, \n)를 포함하고, 그 뒤에 어떠한 문자(줄 바꿈 포함) 2개를 추가로 캡처합니다.
            // . {2}는 모든 문자 2개를 의미합니다.
            const phraseRegex = new RegExp(`[\\s\\r\\n]*${escapedPhrase}[\\s\\r\\n]*.{0,2}`, 'g');
            
            // 해당 패턴을 ')' 문자 하나로 치환합니다.
            // . {0,2}를 사용하여 문구가 줄의 끝에 있을 경우에도 오류 없이 작동하도록 합니다.
            cleanedText = cleanedText.replace(phraseRegex, ')');
            
            // 3. 최종적으로 정리된 텍스트의 앞뒤 공백을 제거합니다. 
            outputTextarea.value = cleanedText.trim(); 

            // 출력 텍스트가 비어있으면 복사 버튼을 비활성화합니다.
            if (cleanedText.trim().length > 0) {
                copyButton.disabled = false;
            } else {
                copyButton.disabled = true;
            }
        }

        /**
         * 정리된 텍스트를 클립보드에 복사하고 성공 메시지를 표시합니다.
         */
        function copyToClipboard() {
            const textToCopy = outputTextarea.value;

            if (textToCopy.trim() === "") {
                return; // 텍스트가 없으면 복사하지 않습니다.
            }
            
            try {
                // 텍스트를 클립보드에 복사합니다.
                outputTextarea.select();
                outputTextarea.setSelectionRange(0, 99999); 
                document.execCommand('copy');
                
                // 성공 메시지 표시
                messageSpan.textContent = '복사 완료! (클립보드에 저장됨)';
                messageSpan.classList.remove('opacity-0', 'text-red-600');
                messageSpan.classList.add('opacity-100', 'text-green-600');

                // 2초 후 메시지 숨기기
                setTimeout(() => {
                    messageSpan.classList.remove('opacity-100');
                    messageSpan.classList.add('opacity-0');
                    messageSpan.textContent = '';
                    
                    // --- 복사 후 초기화 기능 ---
                    inputTextarea.value = '';
                    outputTextarea.value = '';
                    copyButton.disabled = true;
                    // ----------------------------------------

                }, 2000);

            } catch (err) {
                console.error('클립보드 복사 실패:', err);
                messageSpan.textContent = '복사 실패: 콘솔 확인';
                messageSpan.classList.remove('opacity-0', 'text-green-600');
                messageSpan.classList.add('opacity-100', 'text-red-600');
            }
        }

        // --- 이벤트 리스너 설정 ---

        // 입력 텍스트 영역에 내용이 바뀔 때마다 텍스트를 정리합니다.
        inputTextarea.addEventListener('input', cleanText);

        // 버튼 클릭 시 텍스트를 복사합니다.
        copyButton.addEventListener('click', copyToClipboard);

        // 초기 상태 설정
        copyButton.disabled = true; 
        cleanText(); 

    </script>
</body>
</html>
